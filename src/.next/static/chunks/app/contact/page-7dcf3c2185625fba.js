(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[327],{9463:function(e,s,t){Promise.resolve().then(t.bind(t,6658))},6658:function(e,s,t){"use strict";let a;t.r(s),t.d(s,{default:function(){return d}});var r=t(984),l=t(208),n=t(2436),m=t(2022);let c=m.env.NEXT_PUBLIC_SUPABASE_URL||"",i=m.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"";function o(){let[e,s]=(0,l.useState)({name:"",email:"",subject:"",message:""}),[n,m]=(0,l.useState)({}),[c,i]=(0,l.useState)(!1),[o,d]=(0,l.useState)(!1),[u,x]=(0,l.useState)(null),b=()=>{let s={};return e.name.trim()||(s.name="请输入您的姓名"),e.email.trim()?/\S+@\S+\.\S+/.test(e.email)||(s.email="请输入有效的邮箱地址"):s.email="请输入您的邮箱",e.subject.trim()||(s.subject="请输入主题"),e.message.trim()||(s.message="请输入您的消息"),m(s),0===Object.keys(s).length},g=async r=>{if(r.preventDefault(),x(null),b()){i(!0);try{console.log("正在提交用户反馈到user_feedback表...");let{error:r}=await a.from("user_feedback").insert([{name:e.name,email:e.email,subject:e.subject,message:e.message,status:"new",created_at:new Date().toISOString()}]);if(r){if(console.error("提交表单错误:",r),"42P01"===r.code){console.log("表不存在，尝试创建user_feedback表...");let{createUserFeedbackTable:s}=await t.e(342).then(t.bind(t,342));if(!await s())throw Error("创建反馈表失败");let{error:r}=await a.from("user_feedback").insert([{name:e.name,email:e.email,subject:e.subject,message:e.message,status:"new",created_at:new Date().toISOString()}]);if(r)throw r}else throw r}s({name:"",email:"",subject:"",message:""}),d(!0),setTimeout(()=>{d(!1)},5e3)}catch(e){console.error("提交表单时出错:",e),x("提交失败，请稍后重试")}finally{i(!1)}}},h=t=>{let{name:a,value:r}=t.target;s({...e,[a]:r}),n[a]&&m({...n,[a]:void 0})};return(0,r.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 max-w-md mx-auto",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"联系我们"}),o?(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 mb-6",children:(0,r.jsx)("p",{className:"text-green-700",children:"谢谢您的留言！我们会尽快回复您。"})}):(0,r.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[u&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-2",children:(0,r.jsx)("p",{className:"text-red-700",children:u})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"姓名"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",value:e.name,onChange:h,className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none ".concat(n.name?"border-red-500":"border-gray-300")}),n.name&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:n.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"邮箱"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",value:e.email,onChange:h,className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none ".concat(n.email?"border-red-500":"border-gray-300")}),n.email&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:n.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-1",children:"主题"}),(0,r.jsx)("input",{type:"text",id:"subject",name:"subject",value:e.subject,onChange:h,className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none ".concat(n.subject?"border-red-500":"border-gray-300")}),n.subject&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:n.subject})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-1",children:"留言内容"}),(0,r.jsx)("textarea",{id:"message",name:"message",rows:4,value:e.message,onChange:h,className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none ".concat(n.message?"border-red-500":"border-gray-300")}),n.message&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:n.message})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"submit",disabled:c,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md transition duration-300 flex justify-center",children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"提交中..."]}):"提交"})})]})]})}function d(){return(0,r.jsx)("main",{className:"min-h-screen bg-gray-50 py-12",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"联系我们"}),(0,r.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"有任何疑问、建议或合作意向？请填写下方表单与我们联系。"})]}),(0,r.jsx)("div",{className:"mx-auto",children:(0,r.jsx)(o,{})})]})})}a=(0,n.eI)(c,i)}},function(e){e.O(0,[410,115,69,744],function(){return e(e.s=9463)}),_N_E=e.O()}]);