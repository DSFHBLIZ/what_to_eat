(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3613:function(e,t,i){Promise.resolve().then(i.bind(i,5549)),Promise.resolve().then(i.bind(i,3876)),Promise.resolve().then(i.bind(i,5486)),Promise.resolve().then(i.bind(i,4030)),Promise.resolve().then(i.bind(i,1111)),Promise.resolve().then(i.bind(i,3391))},5549:function(e,t,i){"use strict";function s(e){let{reason:t,children:i}=e;return i}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}}),i(6181)},3876:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return l}});var s=i(984),o=i(208),n=i(6665);let r={cookingTime:["10分钟内","30分钟内","1小时内"]};function l(e){let{onTagSelect:t,selectedTags:i=[]}=e;(0,n.useRouter)();let[l,a]=(0,o.useState)([]),[c,d]=(0,o.useState)([]),[u,g]=(0,o.useState)([]),[f,p]=(0,o.useState)({cuisine:[],flavor:[],cookingTime:[],dietaryRestrictions:[],difficulty:[]});(0,o.useEffect)(()=>{if(i&&i.length>0){console.log("同步选中标签到筛选状态:",i);let e=l.map(e=>e.toString()),t=c.map(e=>e.toString()),s=u.map(e=>e.toString()),o=r.cookingTime,n=["新手","简单","中等","高级","大师级"],a={...f};i.forEach(i=>{e.includes(i)?a.cuisine.includes(i)||a.cuisine.push(i):t.includes(i)?a.flavor.includes(i)||a.flavor.push(i):s.includes(i)?a.dietaryRestrictions.includes(i)||a.dietaryRestrictions.push(i):o.includes(i)?a.cookingTime.includes(i)||a.cookingTime.push(i):n.includes(i)&&!a.difficulty.includes(i)&&a.difficulty.push(i)}),p(a)}},[i,l,c,u]),(0,o.useEffect)(()=>{console.log("AdvancedFilters: 加载筛选数据..."),a(["中餐-家常菜","中餐-小吃","中餐-其它"]),d(["酸","咸","苦","辣","鲜","甜"]),g(["清真","纯素","无麸质"]),console.log("加载完成: 菜系",l,"口味",c)},[]),(0,o.useEffect)(()=>{let e=e=>{if(e.detail&&e.detail.tag){let t=e.detail.tag;p(e=>{let i={...e};return i.cuisine.includes(t)?i.cuisine=i.cuisine.filter(e=>e!==t):i.flavor.includes(t)?i.flavor=i.flavor.filter(e=>e!==t):i.cookingTime.includes(t)?i.cookingTime=i.cookingTime.filter(e=>e!==t):i.dietaryRestrictions.includes(t)?i.dietaryRestrictions=i.dietaryRestrictions.filter(e=>e!==t):i.difficulty.includes(t)&&(i.difficulty=i.difficulty.filter(e=>e!==t)),i})}};return document.addEventListener("filter-tag-removed",e),()=>{document.removeEventListener("filter-tag-removed",e)}},[]),(0,o.useEffect)(()=>{let e=()=>{console.log("AdvancedFilters: 收到重置所有筛选器事件"),p({cuisine:[],flavor:[],cookingTime:[],dietaryRestrictions:[],difficulty:[]})};return document.addEventListener("reset-all-filters",e),()=>{document.removeEventListener("reset-all-filters",e)}},[]);let y=(e,i)=>{console.log("点击筛选选项: 类型=".concat(e,", 值=").concat(i)),p(s=>{let o=[...s[e]],n=o.indexOf(i);return n>=0?(o.splice(n,1),t&&t("remove:".concat(i))):(o.push(i),t&&t(i)),{...s,[e]:o}})};return(0,s.jsx)("div",{className:"space-y-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h4",{className:"text-[17px] font-semibold text-gray-800 mb-4",children:"菜系"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-x-2 gap-y-2.5",children:l.map(e=>(0,s.jsx)("button",{onClick:()=>y("cuisine",e),className:"filter-option-button px-3 py-1.5 text-sm rounded-full transition-colors ".concat(f.cuisine.includes(e)?"bg-blue-100 text-blue-700 border-blue-200 border":"bg-gray-100 text-gray-700 border-gray-200 border hover:bg-gray-200"),"data-tag":e,"data-filter-type":"cuisine","data-filter-value":e,"data-filter-active":f.cuisine.includes(e).toString(),children:e},e))})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h4",{className:"text-[17px] font-semibold text-gray-800 mb-4",children:"口味特点"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-x-2 gap-y-2.5",children:c.map(e=>(0,s.jsx)("button",{onClick:()=>y("flavor",e),className:"filter-option-button px-3 py-1.5 text-sm rounded-full transition-colors ".concat(f.flavor.includes(e)?"bg-blue-100 text-blue-700 border-blue-200 border":"bg-gray-100 text-gray-700 border-gray-200 border hover:bg-gray-200"),"data-tag":e,"data-filter-type":"flavor","data-filter-value":e,"data-filter-active":f.flavor.includes(e).toString(),children:e},e))})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h4",{className:"text-[17px] font-semibold text-gray-800 mb-4",children:"烹饪时间"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-x-2 gap-y-2.5",children:r.cookingTime.map(e=>(0,s.jsx)("button",{onClick:()=>y("cookingTime",e),className:"filter-option-button px-3 py-1.5 text-sm rounded-full transition-colors ".concat(f.cookingTime.includes(e)?"bg-blue-100 text-blue-700 border-blue-200 border":"bg-gray-100 text-gray-700 border-gray-200 border hover:bg-gray-200"),"data-tag":e,"data-filter-type":"cookingTime","data-filter-value":e,"data-filter-active":f.cookingTime.includes(e).toString(),children:e},e))})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h4",{className:"text-[17px] font-semibold text-gray-800 mb-4",children:"饮食限制"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-x-2 gap-y-2.5",children:u.map(e=>(0,s.jsx)("button",{onClick:()=>y("dietaryRestrictions",e),className:"filter-option-button px-3 py-1.5 text-sm rounded-full transition-colors ".concat(f.dietaryRestrictions.includes(e)?"bg-blue-100 text-blue-700 border-blue-200 border":"bg-gray-100 text-gray-700 border-gray-200 border hover:bg-gray-200"),"data-tag":e,"data-filter-type":"dietaryRestrictions","data-filter-value":e,"data-filter-active":f.dietaryRestrictions.includes(e).toString(),children:e},e))})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h4",{className:"text-[17px] font-semibold text-gray-800 mb-4",children:"难度"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-x-2 gap-y-2.5",children:["新手","简单","中等","高级","大师级"].map(e=>{var t,i;return(0,s.jsx)("button",{onClick:()=>y("difficulty",e),className:"filter-option-button px-3 py-1.5 text-sm rounded-full transition-colors ".concat((null===(t=f.difficulty)||void 0===t?void 0:t.includes(e))?"bg-blue-100 text-blue-700 border-blue-200 border":"bg-gray-100 text-gray-700 border-gray-200 border hover:bg-gray-200"),"data-tag":e,"data-filter-type":"difficulty","data-filter-value":e,"data-filter-active":null===(i=f.difficulty)||void 0===i?void 0:i.includes(e).toString(),children:e},e)})})]})]})})}},5486:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return u}});var s=i(984),o=i(208),n=i(3391),r=i(8438);function l(e){let t;let i=Array.isArray(e.flavors)?e.flavors.filter(e=>"string"==typeof e&&["酸","咸","苦","辣","鲜","甜","香","麻","清淡","咸鲜","酸甜","麻辣","鲜香","甜酸"].includes(e)):[];e.cuisine&&"string"==typeof e.cuisine&&(t=({川菜:"川菜",粤菜:"粤菜",苏菜:"苏菜",西餐:"西餐",日料:"日料",韩餐:"韩餐",其他:"其他"})[e.cuisine]||"其他");let s=Array.isArray(e.cookingMethod)?e.cookingMethod.filter(e=>"string"==typeof e&&["炒","煮","蒸","煎","炖","烤","焖","拌","炸","焯","烧"].includes(e)):[],o=Array.isArray(e.dietaryRestrictions)?e.dietaryRestrictions.filter(e=>"string"==typeof e&&["纯素","清真","无麸质"].includes(e)):[];return{id:e.id,name:e.name,description:e.description||"",ingredients:Array.isArray(e.ingredients)?e.ingredients:[],seasonings:Array.isArray(e.seasonings)?e.seasonings:[],flavors:i,difficulty:e.difficulty||"中等",cookingTime:"number"==typeof e.cookingTime?e.cookingTime:30,steps:Array.isArray(e.steps)?e.steps:[],preparationSteps:Array.isArray(e.preparationSteps)?e.preparationSteps:void 0,cookingSteps:Array.isArray(e.cookingSteps)?e.cookingSteps:void 0,tips:e.tips||[],cookingTips:Array.isArray(e.cookingTips)?e.cookingTips:void 0,imageUrl:e.imageUrl||"",cuisine:t,cookingMethod:s,dietaryRestrictions:o,tags:Array.isArray(e.tags)?e.tags:[]}}i(342),i(2022);var a=i(3876),c=i(2128),d=i(6665);function u(e){let{initialRecipes:t=[]}=e,i=(0,d.useRouter)(),u=Array.isArray(t)?t:[],[g,f]=(0,o.useState)(u),[p,y]=(0,o.useState)([]),[m,x]=(0,o.useState)([]),[h,b]=(0,o.useState)(void 0),[v,k]=(0,o.useState)(void 0),[S,N]=(0,o.useState)([]),[j,R]=(0,o.useState)([]),[T,A]=(0,o.useState)([]),[E,I]=(0,o.useState)(""),[w,C]=(0,o.useState)(0===u.length),[M,_]=(0,o.useState)(null),[q,P]=(0,o.useState)("");(0,o.useEffect)(()=>{console.log("ClientHome组件加载，初始菜谱数量:",u.length),console.log("当前数据库表名: CHrecipes"),console.log("⚠️ 强制使用示例数据模式"),C(!0);try{console.log("直接加载示例数据...");let e=(console.log("加载示例数据..."),[{id:"1",name:"宫保鸡丁",description:"经典川菜，鸡肉与花生的完美搭配",ingredients:["鸡胸肉","花生","干辣椒","葱","姜","蒜"],seasonings:["酱油","醋","白糖","料酒","淀粉"],flavors:["香","辣"],difficulty:"中等",cookingTime:30,steps:["鸡胸肉切丁，用酱油、料酒和淀粉腌制10分钟","花生提前炒熟或用现成的炒花生米","热油锅，放入干辣椒炒香","倒入腌制好的鸡肉丁，翻炒至变色","加入葱姜蒜末继续翻炒","加入调味料（酱油、醋、白糖）调味","最后加入花生米翻炒均匀即可出锅"],tips:"鸡肉不要炒太久，以免口感变老",imageUrl:"https://picsum.photos/id/102/300/200",cuisine:"川菜",cookingMethod:["炒"],dietaryRestrictions:[]},{id:"2",name:"番茄炒蛋",description:"简单快手的家常菜，酸甜可口",ingredients:["番茄","鸡蛋","葱"],seasonings:["盐","白糖","油"],flavors:["酸","甜"],difficulty:"简单",cookingTime:10,steps:["番茄切块，鸡蛋打散","热锅倒油，倒入鸡蛋炒至金黄","盛出鸡蛋，锅中留底油","倒入番茄块煸炒出汁","加入少许白糖提味","倒入炒好的鸡蛋一起翻炒均匀","最后加盐调味，撒上葱花即可"],tips:"鸡蛋不要炒太久，保持嫩滑口感",imageUrl:"https://picsum.photos/id/292/300/200",cuisine:"其他",cookingMethod:["炒"],dietaryRestrictions:["纯素"]}].map(l));(0,r.mU)(e),f(e),console.log("已加载示例数据:",e.length,"个菜谱")}catch(e){console.error("无法加载示例数据:",e)}C(!1),window.updateRecipesCache=e=>{console.log("接收到后台加载的".concat(e.length,"条菜谱数据，更新状态...")),(0,r.mU)(e),f(t=>p.length||m.length||h||v||S.length||j.length||E?(console.log("存在筛选条件，仅更新缓存不改变显示"),t):(console.log("没有筛选条件，更新显示的菜谱数据"),e))};try{let e=sessionStorage.getItem("additionalRecipes");if(e){let t=JSON.parse(e);if(Array.isArray(t)&&t.length>0){console.log("从sessionStorage恢复了".concat(t.length,"条额外菜谱数据"));let e=[...g,...t];(0,r.mU)(e),p.length||m.length||h||v||S.length||j.length||E||f(e)}}}catch(e){console.warn("从sessionStorage恢复额外数据失败:",e)}},[u]),(0,o.useEffect)(()=>{let e=document.querySelectorAll(".filter-option-button");e.length>0&&(e.forEach(e=>{e._hasClickHandler||(e.addEventListener("click",t=>{let i=e.dataset.tag;console.log("点击筛选选项:",i),i&&L(i)}),e._hasClickHandler=!0)}),console.log("已为",e.length,"个筛选选项添加点击事件处理函数"))},[]);let U=(0,o.useCallback)(async e=>{let t=e.requiredIngredients||p,i=e.optionalIngredients||T,s=e.flavors||[],o=e.difficulty||void 0,n=e.cuisine||void 0,l=e.cookingMethods||[],a=e.dietaryRestrictions||[];x(s),b(o),k(n),N(l),R(a),e.requiredIngredients&&y(e.requiredIngredients),e.optionalIngredients&&A(e.optionalIngredients),C(!0);try{let e=await (0,r.GS)({ingredients:t,optionalIngredients:i,flavors:s,difficulty:o,cuisine:n,cookingMethods:l,dietaryRestrictions:a,searchQuery:E});f(e)}catch(e){console.error("筛选失败:",e),f((0,r.C_)({ingredients:t,optionalIngredients:i,flavors:s,difficulty:o,cuisine:n,cookingMethods:l,dietaryRestrictions:a,searchQuery:E}))}finally{C(!1)}},[E,p,T]);(0,o.useCallback)(async e=>{I(e),C(!0);try{let t=await (0,r.GS)({ingredients:p,flavors:m,difficulty:h,cuisine:v,cookingMethods:S,dietaryRestrictions:j,searchQuery:e});f(t)}catch(t){console.error("搜索失败:",t),f((0,r.C_)({ingredients:p,flavors:m,difficulty:h,cuisine:v,cookingMethods:S,dietaryRestrictions:j,searchQuery:e}))}finally{C(!1)}},[p,m,h,v,S,j]);let L=e=>{if(console.log("选择标签: ".concat(e)),!e||!e.trim()){console.warn("空标签，忽略");return}if("随机推荐"===e){console.log("触发随机推荐功能");let e=new CustomEvent("random-recipe",{bubbles:!0,detail:{action:"random"}});document.dispatchEvent(e),U({flavors:m,difficulty:h,cuisine:v,cookingMethods:S,dietaryRestrictions:j});return}if(console.log("检查标签类型: ".concat(e)),["中餐","西餐","日本料理","韩国料理","意大利菜","法国菜","墨西哥菜","泰国菜","印度菜","中式家常菜"].includes(e))console.log("设置菜系: ".concat(e)),k(e),P((0,c.xx)(q,e)),U({cuisine:e,flavors:m,difficulty:h,cookingMethods:S,dietaryRestrictions:j,requiredIngredients:p,optionalIngredients:T});else if(["咸","甜","酸","辣","鲜","香","麻"].includes(e)){if(console.log("添加口味: ".concat(e)),!m.includes(e)){let t=[...m,e];x(t),P((0,c.xx)(q,e)),U({cuisine:v,flavors:t,difficulty:h,cookingMethods:S,dietaryRestrictions:j,requiredIngredients:p,optionalIngredients:T})}}else if(["新手","简单","中等","高级","大师级"].includes(e))console.log("设置难度: ".concat(e)),b(e),P((0,c.xx)(q,e)),U({cuisine:v,flavors:m,difficulty:e,cookingMethods:S,dietaryRestrictions:j,requiredIngredients:p,optionalIngredients:T});else if(["炒","煮","蒸","煎","炖","烤","焖","拌","炸"].includes(e)){if(console.log("添加烹饪方式: ".concat(e)),!S.includes(e)){let t=[...S,e];N(t),P((0,c.xx)(q,e)),U({cuisine:v,flavors:m,difficulty:h,cookingMethods:t,dietaryRestrictions:j,requiredIngredients:p,optionalIngredients:T})}}else if(["纯素","清真","无麸质"].includes(e)){if(console.log("添加饮食限制: ".concat(e)),!j.includes(e)){let t=[...j,e];R(t),P((0,c.xx)(q,e)),U({cuisine:v,flavors:m,difficulty:h,cookingMethods:S,dietaryRestrictions:t,requiredIngredients:p,optionalIngredients:T})}}else["10分钟内","30分钟内","1小时内"].includes(e)?(console.log("添加烹饪时间: ".concat(e)),P((0,c.xx)(q,e))):(console.log("添加食材: ".concat(e)),p.includes(e)||(y(t=>[...t,e]),P((0,c.xx)(q,e))))};return(0,s.jsxs)("div",{className:"pt-[60px] pb-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("p",{className:"text-lg font-medium text-gray-600 mb-8",children:"从 4000+ 道菜谱中寻找灵感"}),(0,s.jsx)("div",{className:"max-w-[680px] mx-auto",children:(0,s.jsx)(n.default,{placeholder:"请输入食材或调料...",className:"shadow-sm",initialValue:q,onIngredientSearch:(e,t)=>{if(e.length>0||t.length>0){let s=new URLSearchParams;y(e),A(t),e.forEach(e=>{s.append("requiredIngredients",e)}),t.forEach(e=>{s.append("optionalIngredients",e)}),i.push("/recipes?".concat(s.toString()))}}})})]}),(0,s.jsx)("div",{className:"max-w-[900px] mx-auto my-[40px]",children:(0,s.jsx)(a.default,{onTagSelect:L,selectedTags:p})}),(0,s.jsxs)("div",{className:"text-center mt-[40px] mb-8",children:[(0,s.jsx)("p",{className:"text-sm text-gray-400 mb-2 tracking-wide",children:"To Eat or Not to Eat, That Is Not the Question"}),(0,s.jsx)("p",{className:"text-lg font-semibold text-gray-700",children:"The Question Is What to Eat"})]})]})}}},function(e){e.O(0,[346,410,342,438,292,115,69,744],function(){return e(e.s=3613)}),_N_E=e.O()}]);